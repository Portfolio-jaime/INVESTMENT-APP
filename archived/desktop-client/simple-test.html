<!DOCTYPE html>
<html>
<head>
  <title>TRII Desktop - Simple Test</title>
  <style>
    body { font-family: Arial; margin: 20px; background: #f5f5f5; }
    .container { max-width: 1200px; margin: 0 auto; }
    .header { background: #1e3a8a; color: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
    .card { background: white; padding: 20px; border-radius: 8px; margin-bottom: 15px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .quote { display: inline-block; margin: 10px; padding: 15px; background: white; border-radius: 8px; min-width: 250px; }
    .positive { color: #059669; }
    .negative { color: #dc2626; }
    button { padding: 10px 20px; background: #1e3a8a; color: white; border: none; border-radius: 6px; cursor: pointer; margin: 5px; }
    button:hover { background: #1e40af; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>TRII Investment Platform - Desktop Test</h1>
      <p>Conectando a servicios backend...</p>
    </div>

    <div class="card">
      <h2>Market Data Test</h2>
      <button onclick="testMarketData()">Test Market Data Service</button>
      <button onclick="testPortfolio()">Test Portfolio Service</button>
      <div id="results"></div>
    </div>

    <div id="quotes"></div>
  </div>

  <script>
    async function testMarketData() {
      const results = document.getElementById('results');
      results.innerHTML = '<p>Fetching AAPL quote...</p>';
      
      try {
        const response = await fetch('http://localhost:8001/api/v1/market-data/quotes/AAPL');
        const data = await response.json();
        
        const isPositive = data.change >= 0;
        results.innerHTML = `
          <div class="quote">
            <h3>${data.symbol}</h3>
            <div style="font-size: 24px; font-weight: bold;">$${data.price.toFixed(2)}</div>
            <div class="${isPositive ? 'positive' : 'negative'}">
              ${isPositive ? '▲' : '▼'} ${data.change.toFixed(2)} (${data.change_percent.toFixed(2)}%)
            </div>
            <div style="font-size: 12px; color: #666; margin-top: 10px;">
              Volume: ${(data.volume / 1000000).toFixed(1)}M
            </div>
          </div>
        `;

        // Fetch more quotes
        const symbols = ['GOOGL', 'MSFT', 'TSLA'];
        const quotesDiv = document.getElementById('quotes');
        quotesDiv.innerHTML = '<div class="card"><h2>Live Quotes</h2></div>';
        
        for (const symbol of symbols) {
          const resp = await fetch(`http://localhost:8001/api/v1/market-data/quotes/${symbol}`);
          const quote = await resp.json();
          const pos = quote.change >= 0;
          
          quotesDiv.innerHTML += `
            <div class="quote">
              <h3>${quote.symbol}</h3>
              <div style="font-size: 24px; font-weight: bold;">$${quote.price.toFixed(2)}</div>
              <div class="${pos ? 'positive' : 'negative'}">
                ${pos ? '▲' : '▼'} ${quote.change.toFixed(2)} (${quote.change_percent.toFixed(2)}%)
              </div>
            </div>
          `;
        }
      } catch (error) {
        results.innerHTML = '<p style="color: red;">Error: ' + error.message + '</p>';
      }
    }

    async function testPortfolio() {
      const results = document.getElementById('results');
      results.innerHTML = '<p>Fetching portfolios...</p>';
      
      try {
        const response = await fetch('http://localhost:8003/api/v1/portfolios');
        const data = await response.json();
        
        if (data.data && data.data.length > 0) {
          results.innerHTML = '<h3>Portfolios Found:</h3>';
          data.data.forEach(p => {
            results.innerHTML += `<div class="quote"><strong>${p.name}</strong><br>${p.description}</div>`;
          });
        } else {
          results.innerHTML = '<p>No portfolios found</p>';
        }
      } catch (error) {
        results.innerHTML = '<p style="color: red;">Error: ' + error.message + '</p>';
      }
    }

    // Auto-load on page load
    window.onload = () => {
      testMarketData();
    };
  </script>
</body>
</html>
